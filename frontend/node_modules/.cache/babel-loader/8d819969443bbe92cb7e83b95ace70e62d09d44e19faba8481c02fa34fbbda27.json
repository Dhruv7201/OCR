{"ast":null,"code":"import React,{useEffect,useRef}from\"react\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const VideoStream=_ref=>{let{videoConstraints,videoRef,canvasRef,sendFrameToBackend}=_ref;const streamRef=useRef(null);useEffect(()=>{const startVideo=async()=>{if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){try{const stream=await navigator.mediaDevices.getUserMedia({video:videoConstraints});videoRef.current.srcObject=stream;videoRef.current.onloadedmetadata=()=>{videoRef.current.play();};streamRef.current=stream;}catch(error){console.error(\"Error accessing webcam:\",error);}}else{console.error(\"navigator.mediaDevices.getUserMedia is not supported in this browser.\");}};startVideo();const captureInterval=setInterval(sendFrameToBackend,5000);return()=>{clearInterval(captureInterval);if(streamRef.current){streamRef.current.getTracks().forEach(track=>track.stop());}};},[sendFrameToBackend,videoConstraints,videoRef]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"video\",{ref:videoRef,autoPlay:true,playsInline:true,width:videoConstraints.width,height:videoConstraints.height}),/*#__PURE__*/_jsx(\"canvas\",{ref:canvasRef,style:{display:\"none\"}})]});};export default VideoStream;","map":{"version":3,"names":["React","useEffect","useRef","jsx","_jsx","jsxs","_jsxs","VideoStream","_ref","videoConstraints","videoRef","canvasRef","sendFrameToBackend","streamRef","startVideo","navigator","mediaDevices","getUserMedia","stream","video","current","srcObject","onloadedmetadata","play","error","console","captureInterval","setInterval","clearInterval","getTracks","forEach","track","stop","children","ref","autoPlay","playsInline","width","height","style","display"],"sources":["/home/ethics/workspace/ethics-medicinebox-ai/frontend/src/components/VideoStream.jsx"],"sourcesContent":["import React, { useEffect, useRef } from \"react\";\n\nconst VideoStream = ({\n  videoConstraints,\n  videoRef,\n  canvasRef,\n  sendFrameToBackend,\n}) => {\n  const streamRef = useRef(null);\n\n  useEffect(() => {\n    const startVideo = async () => {\n      if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n        try {\n          const stream = await navigator.mediaDevices.getUserMedia({\n            video: videoConstraints,\n          });\n          videoRef.current.srcObject = stream;\n          videoRef.current.onloadedmetadata = () => {\n            videoRef.current.play();\n          };\n          streamRef.current = stream;\n        } catch (error) {\n          console.error(\"Error accessing webcam:\", error);\n        }\n      } else {\n        console.error(\n          \"navigator.mediaDevices.getUserMedia is not supported in this browser.\"\n        );\n      }\n    };\n\n    startVideo();\n\n    const captureInterval = setInterval(sendFrameToBackend, 5000);\n\n    return () => {\n      clearInterval(captureInterval);\n      if (streamRef.current) {\n        streamRef.current.getTracks().forEach((track) => track.stop());\n      }\n    };\n  }, [sendFrameToBackend, videoConstraints, videoRef]);\n\n  return (\n    <div>\n      <video\n        ref={videoRef}\n        autoPlay\n        playsInline\n        width={videoConstraints.width}\n        height={videoConstraints.height}\n      />\n      <canvas ref={canvasRef} style={{ display: \"none\" }} />\n    </div>\n  );\n};\n\nexport default VideoStream;\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,MAAM,KAAQ,OAAO,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAEjD,KAAM,CAAAC,WAAW,CAAGC,IAAA,EAKd,IALe,CACnBC,gBAAgB,CAChBC,QAAQ,CACRC,SAAS,CACTC,kBACF,CAAC,CAAAJ,IAAA,CACC,KAAM,CAAAK,SAAS,CAAGX,MAAM,CAAC,IAAI,CAAC,CAE9BD,SAAS,CAAC,IAAM,CACd,KAAM,CAAAa,UAAU,CAAG,KAAAA,CAAA,GAAY,CAC7B,GAAIC,SAAS,CAACC,YAAY,EAAID,SAAS,CAACC,YAAY,CAACC,YAAY,CAAE,CACjE,GAAI,CACF,KAAM,CAAAC,MAAM,CAAG,KAAM,CAAAH,SAAS,CAACC,YAAY,CAACC,YAAY,CAAC,CACvDE,KAAK,CAAEV,gBACT,CAAC,CAAC,CACFC,QAAQ,CAACU,OAAO,CAACC,SAAS,CAAGH,MAAM,CACnCR,QAAQ,CAACU,OAAO,CAACE,gBAAgB,CAAG,IAAM,CACxCZ,QAAQ,CAACU,OAAO,CAACG,IAAI,CAAC,CAAC,CACzB,CAAC,CACDV,SAAS,CAACO,OAAO,CAAGF,MAAM,CAC5B,CAAE,MAAOM,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,yBAAyB,CAAEA,KAAK,CAAC,CACjD,CACF,CAAC,IAAM,CACLC,OAAO,CAACD,KAAK,CACX,uEACF,CAAC,CACH,CACF,CAAC,CAEDV,UAAU,CAAC,CAAC,CAEZ,KAAM,CAAAY,eAAe,CAAGC,WAAW,CAACf,kBAAkB,CAAE,IAAI,CAAC,CAE7D,MAAO,IAAM,CACXgB,aAAa,CAACF,eAAe,CAAC,CAC9B,GAAIb,SAAS,CAACO,OAAO,CAAE,CACrBP,SAAS,CAACO,OAAO,CAACS,SAAS,CAAC,CAAC,CAACC,OAAO,CAAEC,KAAK,EAAKA,KAAK,CAACC,IAAI,CAAC,CAAC,CAAC,CAChE,CACF,CAAC,CACH,CAAC,CAAE,CAACpB,kBAAkB,CAAEH,gBAAgB,CAAEC,QAAQ,CAAC,CAAC,CAEpD,mBACEJ,KAAA,QAAA2B,QAAA,eACE7B,IAAA,UACE8B,GAAG,CAAExB,QAAS,CACdyB,QAAQ,MACRC,WAAW,MACXC,KAAK,CAAE5B,gBAAgB,CAAC4B,KAAM,CAC9BC,MAAM,CAAE7B,gBAAgB,CAAC6B,MAAO,CACjC,CAAC,cACFlC,IAAA,WAAQ8B,GAAG,CAAEvB,SAAU,CAAC4B,KAAK,CAAE,CAAEC,OAAO,CAAE,MAAO,CAAE,CAAE,CAAC,EACnD,CAAC,CAEV,CAAC,CAED,cAAe,CAAAjC,WAAW"},"metadata":{},"sourceType":"module","externalDependencies":[]}